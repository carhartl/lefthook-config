---
extends:
  - base.yaml
pre-commit:
  parallel: true
  commands:
    terraform-fmt:
      tags: style terraform
      glob: "*.{tf,tfvars}"
      stage_fixed: true
      run: terraform fmt -write {staged_files}
    tflint:
      tags: lint terraform
      glob: "*.{tf,tfvars}"
      stage_fixed: true
      # NOTE: with --chdir must use TFLINT_CONFIG_FILE env var for pointing TFLint to config file
      # at say the project root..
      run: |
        for file in {staged_files}; do
          tflint --chdir=$(dirname "$file") --filter=$(basename "$file") --fix
        done
